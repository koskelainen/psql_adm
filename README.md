# Задания по PostgreSQL

## Подготовка PostgreSQL и pgAdmin
Задания представленые ниже, необходимо выполнить на PostgreSQL 14

Для запуска PostgreSQL + pgAdmin нужно запустить docker-compose
```shell
docker-compose up -d
```
,где `docker-compose.yml` файл конфигурации 

для консольного подключения к PostgreSQL
```shell
psql -h localhost -p 15432 -U admin -d mydb
```
,а пароль `admin` 

для работы через pgAdmin(web-ui) нужно использовать url:  `http://localhost:16543/`

    LOGIN: "admin@admin.com"
    PASSWORD: "admin"

---
## Задачи:
### 1) Corp
 - Инициализация базы `db_init_q01.sql` с данными. Для выполнения задания просьба использовать этот файл.

Даны таблицы: company_divisions, company_regions, staff

#### a) Нужно написать код, который позволит вывести список: регоин, дельта минимальной зарплаты между гендорами, дельта максимальной зарплаты между  гендорами
#### b) Нужно написать код, который выведет процентили зарплат 0.50, 0.60, 0.90, 0.95 в каждом регионе стран. 
#### c) Добавить в существующую схему constraint для company_division в таблице company_divisions
#### d) Создать view для представления списка: company_regions.company_regions, company_divisions.department, staff.last_name, staff.job_title. И в список попадают только те сотрудники, у которых в job_title упоминается "director"
#### e) Создать индексы для повышения скорости работы view, которую создавали в предыдущем задании.

### 2) Authors
 - Инициализация базы `db_init_q02.sql` с данными. Для выполнения задания просьба использовать этот файл.

#### a) Нужно написать код, который позводит вывести список всех авторов, их самой дорогой книги, самой дешевой книги и количество написанных ими книг, цена которых превышает 10 долларов, в порядке убывания количества написанных книг.

Даны таблицы: AUTHORS, BOOKS 

Примечания по заданию:

Первый столбец должен быть AUTHOR_NAME и должен включать первую букву имени автора и его фамилию (например, «M FRIED»).
Если два или более авторов написали одинаковое количество книг, запрос должен упорядочить их по цене самой дорогой книги в порядке убывания.
Если два или более авторов написали одинаковое количество книг и цена самой дорогой их книги одинакова, то расположите их по фамилии автора в алфавитном порядке.
Если автор не написал ни одной книги по цене выше 10 долларов, не отображать автора
Для данного набора данных результаты должны выглядеть так:

| author_name | max   | min   | count |
| ----------- | ----- | ----- | ----- |
| B FREEMAN   | 23.99 | 10.99 | 4     |
| T GREENE    | 34.99 | 19.99 | 3     |
| F SNITKER   | 71.99 | 49.99 | 2     |
| O ACUNA     | 39.99 | 29.99 | 2     |
| T RILEY     | 23.99 | 9.99  | 2     |
| M MINTER    | 49.99 | 4.99  | 1     |
| A RAGONE    | 31.99 | 31.99 | 1     |
| M SMYLY     | 21.99 | 5.99  | 1     |

---
